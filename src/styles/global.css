@import "tailwindcss";
@import "./tokens.css";

@layer base {
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}

	/* Opt into stable layout when scrollbars appear/disappear in supporting browsers */
	html { scrollbar-gutter: stable both-edges; }

	body {
		background-color: var(--color-bg);
		font-family: Inter, Roboto, 'Helvetica Neue', 'Arial Nova', 'Nimbus Sans', Arial, sans-serif;
	}

	header {
		background-color: transparent;
		position: static;
		top: auto;
		z-index: auto;
	}

	.header-inner {
		display: contents;
	}

	main {
		padding: 24px 16px;
	}

	button {
		@apply cursor-pointer;
	}

	button:disabled {
		@apply cursor-not-allowed;
	}

	[role="button"] {
		@apply cursor-pointer;
	}
}

@layer components {
	/* Reusable squiggly underline effect for links */
	.squiggle-underline {
		position: relative;
		display: inline-block;
		--underline-angle: 0deg;
		--underline-offset: -0.12em; /* place underline slightly below text */
		--underline-thickness: 0.24em;
		--wiggle-duration: 240ms; /* transition duration for reveal */
		--wiggle-delay: 0ms;
		--sq-x1: 20%;
		--sq-y1: 45%;
		--sq-x2: 80%;
		--sq-y2: 55%;
		padding-bottom: 0.2em; /* ensure comfortable gap */
	}

	.squiggle-underline::after {
		content: "";
		position: absolute;
		left: 0;
		bottom: var(--underline-offset);
		width: 100%;
		height: var(--underline-thickness);
		background: var(--color-brand);
		transform-origin: left center;
		transform: scaleX(0) rotate(var(--underline-angle));
		transition: transform var(--wiggle-duration) cubic-bezier(.65,.05,.36,1);
		opacity: 0.9;
		/* initial squiggle shape */
		clip-path: polygon(
			0 40%,
			var(--sq-x1) var(--sq-y1),
			var(--sq-x2) var(--sq-y2),
			100% 60%,
			100% 100%,
			0 100%
		);
	}

	.squiggle-underline:hover::after,
	.squiggle-underline:focus-visible::after,
	.group:hover .squiggle-underline::after,
	.group:focus-visible .squiggle-underline::after {
		transform: scaleX(1) rotate(var(--underline-angle));
		animation: squiggle-underline-wiggle 1s ease-in-out infinite;
		animation-delay: var(--wiggle-delay);
	}

	@keyframes squiggle-underline-wiggle {
		0% {
			clip-path: polygon(
				0 40%,
				var(--sq-x1) calc(var(--sq-y1) - 8%),
				var(--sq-x2) calc(var(--sq-y2) + 8%),
				100% 60%,
				100% 100%,
				0 100%
			);
		}
		50% {
			clip-path: polygon(
				0 60%,
				var(--sq-x1) calc(var(--sq-y1) + 8%),
				var(--sq-x2) calc(var(--sq-y2) - 8%),
				100% 40%,
				100% 100%,
				0 100%
			);
		}
		100% {
			clip-path: polygon(
				0 40%,
				var(--sq-x1) calc(var(--sq-y1) - 8%),
				var(--sq-x2) calc(var(--sq-y2) + 8%),
				100% 60%,
				100% 100%,
				0 100%
			);
		}
	}

	@media (prefers-reduced-motion: reduce) {
		.squiggle-underline:hover::after,
		.squiggle-underline:focus-visible::after,
		.group:hover .squiggle-underline::after,
		.group:focus-visible .squiggle-underline::after {
			animation: none;
		}
	}
}

@layer utilities {
    /* Sidebar shadow only when expanded */
    html[data-sidebar-open="true"] #site-sidebar {
		box-shadow:
			-16px 0 24px rgba(0, 0, 0, 0.12),
			-4px 0 12px rgba(0, 0, 0, 0.08);
    }

    @media (prefers-color-scheme: dark) {
        html[data-sidebar-open="true"] #site-sidebar {
			box-shadow:
				-14px 0 20px rgba(0, 0, 0, 0.10),
				-3px 0 10px rgba(0, 0, 0, 0.06);
        }
    }
	/* Remove all focus outlines and rings inside the sidebar */
	#site-sidebar :is(a, button, [tabindex], input, select, textarea):focus,
	#site-sidebar :is(a, button, [tabindex], input, select, textarea):focus-visible {
		outline: none !important;
		box-shadow: none !important;
	}

	/* Remove focus outline on the sidebar container itself */
	#site-sidebar:focus,
	#site-sidebar:focus-visible {
		outline: none !important;
	}
}

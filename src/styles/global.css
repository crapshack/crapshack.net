@import "tailwindcss";
@import "./tokens.css";
@import "./weather.css";

@layer base {
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}

	body {
		background-color: var(--color-bg);
		font-family: Inter, Roboto, 'Helvetica Neue', 'Arial Nova', 'Nimbus Sans', Arial, sans-serif;
	}

	header {
		background-color: transparent;
		position: static;
		top: auto;
		z-index: auto;
	}

	.header-inner {
		display: contents;
	}

	main {
		padding: 24px 16px;
	}

	button {
		@apply cursor-pointer;
	}

	button:disabled {
		@apply cursor-not-allowed;
	}

	[role="button"] {
		@apply cursor-pointer;
	}
}

@layer components {
	/* ToggleGroup component */
	.toggle-group {
		display: inline-flex;
		padding: 0.25rem;
		gap: 0.25rem;
		background: rgba(0, 0, 0, 0.3);
		border-radius: 0.5rem;
	}

	.toggle-option {
		display: block;
		cursor: pointer;
	}

	.toggle-label {
		display: block;
		padding: 0.5rem 1rem;
		border-radius: 0.375rem;
		font-size: 0.875rem;
		font-weight: 500;
		color: rgba(255, 255, 255, 0.6);
		background: transparent;
		transition:
			color 150ms ease,
			background 150ms ease,
			box-shadow 150ms ease;
	}

	.toggle-option:hover .toggle-label {
		color: rgba(255, 255, 255, 0.9);
		background: rgba(255, 255, 255, 0.05);
	}

	.toggle-option:has(input:checked) .toggle-label {
		color: white;
		background: rgba(255, 255, 255, 0.15);
		box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
	}

	.toggle-option:has(input:focus-visible) .toggle-label {
		outline: none;
		box-shadow: 0 0 0 2px var(--color-brand, #fdd0e0);
	}

	/* Dialog component */
	.dialog-root {
		position: fixed;
		inset: 0;
		z-index: 200;
		display: flex;
		align-items: center;
		justify-content: center;
		padding: 1.5rem;
		pointer-events: none;
		visibility: hidden;
	}

	.dialog-root[data-open="true"] {
		pointer-events: auto;
		visibility: visible;
	}

	.dialog-backdrop {
		position: absolute;
		inset: 0;
		background: rgba(0, 0, 0, 0.75);
		backdrop-filter: blur(8px);
		-webkit-backdrop-filter: blur(8px);
		opacity: 0;
		transition: opacity 200ms ease-out;
	}

	.dialog-root[data-open="true"] .dialog-backdrop {
		opacity: 1;
	}

	.dialog-container {
		position: relative;
		width: 100%;
		background: linear-gradient(
			145deg,
			rgba(30, 41, 59, 0.95) 0%,
			rgba(15, 23, 42, 0.98) 100%
		);
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: 1rem;
		box-shadow:
			0 25px 50px -12px rgba(0, 0, 0, 0.5),
			0 0 0 1px rgba(255, 255, 255, 0.05) inset;
		outline: none;
		opacity: 0;
		transform: scale(0.95) translateY(10px);
		transition:
			opacity 200ms ease-out,
			transform 200ms ease-out;
	}

	.dialog-root[data-open="true"] .dialog-container {
		opacity: 1;
		transform: scale(1) translateY(0);
	}

	.dialog-close {
		position: absolute;
		top: 0.75rem;
		right: 0.75rem;
		z-index: 10;
		display: flex;
		align-items: center;
		justify-content: center;
		width: 2.25rem;
		height: 2.25rem;
		padding: 0;
		background: rgba(255, 255, 255, 0.1);
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: 0.5rem;
		color: rgba(255, 255, 255, 0.7);
		cursor: pointer;
		transition:
			background 150ms ease,
			color 150ms ease,
			transform 150ms ease;
	}

	.dialog-close:hover {
		background: rgba(255, 255, 255, 0.15);
		color: white;
		transform: scale(1.05);
	}

	.dialog-close:active {
		transform: scale(0.95);
	}

	.dialog-close:focus-visible {
		outline: none;
		box-shadow: 0 0 0 2px var(--color-brand, #fdd0e0);
	}

	.dialog-content {
		padding: 1.5rem;
		overflow: auto;
		max-height: calc(100vh - 6rem);
	}

	@media (prefers-reduced-motion: reduce) {
		.dialog-backdrop,
		.dialog-container {
			transition: none;
		}
	}

	/* Reusable squiggly underline effect for links */
	.squiggle-underline {
		position: relative;
		display: inline-block;
		--underline-angle: 0deg;
		--underline-offset: -0.12em;
		--underline-thickness: 0.24em;
		--wiggle-duration: 240ms;
		--wiggle-delay: 0ms;
		--sq-x1: 20%;
		--sq-y1: 45%;
		--sq-x2: 80%;
		--sq-y2: 55%;
		padding-bottom: 0.2em;
	}

	.squiggle-underline::after {
		content: "";
		position: absolute;
		left: 0;
		bottom: var(--underline-offset);
		width: 100%;
		height: var(--underline-thickness);
		background: var(--color-brand);
		transform-origin: left center;
		transform: scaleX(0) rotate(var(--underline-angle));
		transition: transform var(--wiggle-duration) cubic-bezier(.65,.05,.36,1);
		opacity: 0.9;
		clip-path: polygon(
			0 40%,
			var(--sq-x1) var(--sq-y1),
			var(--sq-x2) var(--sq-y2),
			100% 60%,
			100% 100%,
			0 100%
		);
	}

	.squiggle-underline:hover::after,
	.squiggle-underline:focus-visible::after,
	.group:hover .squiggle-underline::after,
	.group:focus-visible .squiggle-underline::after {
		transform: scaleX(1) rotate(var(--underline-angle));
		animation: squiggle-underline-wiggle 1s ease-in-out infinite;
		animation-delay: var(--wiggle-delay);
	}

	@keyframes squiggle-underline-wiggle {
		0% {
			clip-path: polygon(
				0 40%,
				var(--sq-x1) calc(var(--sq-y1) - 8%),
				var(--sq-x2) calc(var(--sq-y2) + 8%),
				100% 60%,
				100% 100%,
				0 100%
			);
		}
		50% {
			clip-path: polygon(
				0 60%,
				var(--sq-x1) calc(var(--sq-y1) + 8%),
				var(--sq-x2) calc(var(--sq-y2) - 8%),
				100% 40%,
				100% 100%,
				0 100%
			);
		}
		100% {
			clip-path: polygon(
				0 40%,
				var(--sq-x1) calc(var(--sq-y1) - 8%),
				var(--sq-x2) calc(var(--sq-y2) + 8%),
				100% 60%,
				100% 100%,
				0 100%
			);
		}
	}

	@media (prefers-reduced-motion: reduce) {
		.squiggle-underline:hover::after,
		.squiggle-underline:focus-visible::after,
		.group:hover .squiggle-underline::after,
		.group:focus-visible .squiggle-underline::after {
			animation: none;
		}
	}
}

@layer utilities {
	/* Sidebar shadow only when expanded */
	html[data-sidebar-open="true"] #site-sidebar {
		box-shadow:
			-16px 0 24px rgba(0, 0, 0, 0.12),
			-4px 0 12px rgba(0, 0, 0, 0.08);
	}

	@media (prefers-color-scheme: dark) {
		html[data-sidebar-open="true"] #site-sidebar {
			box-shadow:
				-14px 0 20px rgba(0, 0, 0, 0.10),
				-3px 0 10px rgba(0, 0, 0, 0.06);
		}
	}

	/* Remove all focus outlines and rings inside the sidebar */
	#site-sidebar :is(a, button, [tabindex], input, select, textarea):focus,
	#site-sidebar :is(a, button, [tabindex], input, select, textarea):focus-visible {
		outline: none !important;
		box-shadow: none !important;
	}

	/* Remove focus outline on the sidebar container itself */
	#site-sidebar:focus,
	#site-sidebar:focus-visible {
		outline: none !important;
	}
}
